function de_dt_F(s,t,p)

!   d(entropy)/dt from twice differentiating the Gibbs potential in
!   Feistel (2003), Prog. Ocean. 58, 43-114
!
!   s                : salinity                           (psu)
!   t                : in-situ temperature                (deg C, ITS-90)
!   p                : gauge pressure                     (dbar)
!                      (absolute pressure - 10.1325 dbar)
!
!   de_dt_F          : d(entropy)/dt                      (J/kgK^2)
!
!   check value      : de_dt_F(35,20,4000) = 13.35022011370635
!
!   DRJ on 10/12/03


implicit real*8(a-h,o-z)


x2 = 2.5d-2*s; x = sqrt(x2); y = 2.5d-2*t; z = 1.0d-4*p

de_dt = 24715.571866078d0 + x2*(-1858.920033948178d0 + &
                x*(317.440355256842d0 + y*(-405.1392883572282d0 + &
               202.6815298758072d0*y)) + y*(1562.563716288858d0 + &
               y*(-1165.8752731900836d0 + 348.7487684426d0*y))) + &
              y*(-4420.4472249096725d0 + y*(1778.231237203896d0 + &
                 y*(-1160.5182516851419d0 + (569.531539542516d0 - &
                                   128.13429152494615d0*y)*y)))


if(z.ne.0.d0) then
    de_dt = de_dt + &
                z*(-2910.0729080936d0 + x2*(1721.528607567954d0 + &
             y*(-4165.4688847996085d0 + 3572.7449038462437d0*y) + &
                 x*(-766.116132004952d0 + (2761.9195908075417d0 - &
              2814.78225133626d0*y)*y)) + y*(4035.04669887042d0 + &
                 y*(-4775.621344883664d0 + y*(3892.3662123519d0 + &
           y*(-1905.341809925355d0 + 404.50541014508605d0*y)))) + &
               z*(1513.116771538718d0 + x2*(-674.819060538734d0 + &
                   108.3834525034224d0*x + (1229.337851789418d0 - &
             896.713693665072d0*y)*y) + y*(-2996.162344914912d0 + &
                 y*(3621.784567462512d0 + y*(-2410.4130980405d0 + &
               668.691951421377d0*y))) + z*(-546.959324647056d0 + &
                  x2*(356.629112415276d0 - 51.2796974779828d0*x + &
              y*(-681.370187043564d0 + 437.84750280190565d0*y)) + &
              y*(1437.2719839264719d0 + y*(-1826.356460806092d0 + &
             (1105.446104680304d0 - 245.11816254543362d0*y)*y)) + &
                  z*(111.1208127634436d0 + x2*(-88.4080716616d0 + &
                66.7696405958478d0*y) + y*(-292.8075111563232d0 + &
              (316.49805267936244d0 - 129.6381336154442d0*y)*y) + &
                  (-8.68841343834394d0 + 15.84003094423364d0*x2 + &
                                   9.978426372534301d0*y)*z))))

end if            


de_dt_F = 6.25d-4*de_dt


return
end
