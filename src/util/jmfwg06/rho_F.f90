function rho_F(s,t,p)

!   density from differentiating the Gibbs potential in
!   Feistel (2003), Prog. Ocean. 58, 43-114
!
!   s                : salinity                           (psu)
!   t                : in-situ temperature                (deg C, ITS-90)
!   p                : gauge pressure                     (dbar)
!                      (absolute pressure - 10.1325 dbar)
!
!   rho_F            : in-situ density                    (kg/m^3)
!
!   check value      : rho_F(20,20,1000) = 1017.775902096646
!
!   DRJ on 11/12/03


implicit real*8(a-h,o-z)


x2 = 2.5d-2*s; x = sqrt(x2); y = 2.5d-2*t; z = 1.0d-4*p

sv_tmp = 100015.695367145d0 + z*(-5089.1530840726d0 + &
               z*(853.5533353388611d0 + z*(-133.2587017014444d0 +  &
              (21.0131554401542d0 - 3.278571068826234d0*z)*z))) +  &
                x2*(-3310.49154044839d0 + z*(769.588305957198d0 +  &
                  z*(-289.5972960322374d0 + (63.3632691067296d0 -  &
              13.1240078295496d0*z)*z)) + x*(199.459603073901d0 +  &
                  x*(-54.7919133532887d0 + 36.0284195611086d0*x -  &
                    22.6683558512829d0*y + (-8.16387957824522d0 -  &
             90.52653359134831d0*z)*z) + z*(-104.588181856267d0 +  &
               (204.1334828179377d0 - 13.65007729765128d0*z)*z) +  &
                  y*(-175.292041186547d0 + (166.3847855603638d0 -  &
                 88.449193048287d0*z)*z + y*(383.058066002476d0 +  &
                 y*(-460.319931801257d0 + 234.565187611355d0*y) +  &
             z*(-108.3834525034224d0 + 76.9195462169742d0*z)))) +  &
                 y*(729.116529735046d0 + z*(-687.913805923122d0 +  &
                 z*(374.063013348744d0 + z*(-126.627857544292d0 +  &
              35.23294016577245d0*z))) + y*(-860.764303783977d0 +  &
                 y*(694.244814133268d0 + y*(-297.728741987187d0 +  &
               (149.452282277512d0 - 109.46187570047641d0*z)*z) +  &
                   z*(-409.779283929806d0 + (340.685093521782d0 -  &
              44.5130937305652d0*z)*z)) + z*(674.819060538734d0 +  &
                     z*(-534.943668622914d0 + (176.8161433232d0 -  &
        39.600077360584095d0*z)*z))))) + y*(-270.983805184062d0 +  &
                 z*(1552.307223226202d0 + z*(-589.53765264366d0 +  &
               (115.91861051767d0 - 10.664504175916349d0*z)*z)) +  &
                 y*(1455.0364540468d0 + z*(-1513.116771538718d0 +  &
                z*(820.438986970584d0 + z*(-222.2416255268872d0 +  &
               21.72103359585985d0*z))) + y*(-672.50778314507d0 +  &
                z*(998.720781638304d0 + z*(-718.6359919632359d0 +  &
               (195.2050074375488d0 - 8.31535531044525d0*z)*z)) +  &
                 y*(397.968445406972d0 + z*(-603.630761243752d0 +  &
                (456.589115201523d0 - 105.4993508931208d0*z)*z) +  &
                 y*(-194.618310617595d0 + y*(63.5113936641785d0 -  &
                  9.63108119393062d0*y + z*(-44.5794634280918d0 +  &
                24.511816254543362d0*z)) + z*(241.04130980405d0 +  &
         z*(-165.8169157020456d0 + 25.92762672308884d0*z)))))))


rho_F = 1.d+8/sv_tmp


!     Note:   specific volume = 1.0d-8*sv_tmp
!
!		    this function should always be run in double precision
!             (since rho is returned rather than sigma = rho-1.0d3)


return
end
